
<!DOCTYPE html>
<html lang="cn">
<head>
    <meta charset="utf-8" />
    <title>C++例题-Bamilen数据库模拟 | Ksayus の 猫窝</title>
    <meta name="author" content="Ksayus" />
    <meta name="description" content="喵~" />
    <meta name="keywords" content="" />
    <meta
        name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
    <link rel="icon" href="/images/basic/avatar.jpg" />
    <link rel="preconnect" href="https://s4.zstatic.net" />
<script src="https://s4.zstatic.net/ajax/libs/vue/3.3.7/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
<link rel="preconnect" href="https://fonts.googleapis.cn" />
<link rel="preconnect" href="https://fonts.gstatic.cn" crossorigin />
<link
    rel="stylesheet"
    href="https://fonts.googleapis.cn/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap"
/>
<script> const mixins = {}; </script>

<script src="https://polyfill.alicdn.com/v3/polyfill.min.js?features=default"></script>


<script src="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://s4.zstatic.net/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link
    rel="stylesheet"
    href="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>



<script src="/js/lib/preview.js"></script>







<script src="https://s4.zstatic.net/ajax/libs/twikoo/1.6.31/twikoo.all.min.js"></script>



<link rel="stylesheet" href="/css/main.css" />

<meta name="generator" content="Hexo 7.3.0"></head>
<body>
    <div id="layout">
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>加载过慢请开启缓存 浏览器默认开启</p>
                    <img src="/images/basic/loading.gif" />
                </div>
            </div>
        </transition>
        <div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <nav id="desktop-menu">
        <a class="title" href="/">
            <span>KSAYUS の 猫窝</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;主页</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;文章</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;分类</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;标签</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;关于</span>
        </a>
        
    </nav>
    <nav id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;KSAYUS の 猫窝</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">主页</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">文章</div>
                    </div>
                </a>
                
                <a href="/categories">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">分类</div>
                    </div>
                </a>
                
                <a href="/tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">标签</div>
                    </div>
                </a>
                
                <a href="/about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">关于</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </nav>
</div>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

        <div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'">
            <div class="article">
    <div>
        <h1>C++例题-Bamilen数据库模拟</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2024/11/9
        </span>
        
        
    </div>
    
    <div class="content" v-pre>
        <h1 id="制作Bamilen网站用户信息数据库存储查询系统"><a href="#制作Bamilen网站用户信息数据库存储查询系统" class="headerlink" title="制作Bamilen网站用户信息数据库存储查询系统"></a>制作Bamilen网站用户信息数据库存储查询系统</h1><p>所谓数据__数据库__，其实就是一个用于存储数据的存储库，一个网站的用户__数据__就是利用数据库对数据进行分类管理的，常用的是__MySQL数据库__,但我们这次不使用__MySQL__，而是基于C++当中的__结构体__<code>struct</code>变量进行实现</p>
<p>一个数据库需要拥有的基础功能：  </p>
<ul>
<li>__添加__用户</li>
<li>__删除__用户</li>
<li>__显示__用户</li>
<li>__查找__用户</li>
<li><strong>修改__用户__数据</strong></li>
<li>__格式化__数据库</li>
<li>__退出__数据库管理系统</li>
</ul>
<h3 id="一，菜单-Menu-制作"><a href="#一，菜单-Menu-制作" class="headerlink" title="一，菜单(Menu)制作"></a>一，菜单(Menu)制作</h3><p>这个没什么好讲的，毕竟是基础<br>直接上代码</p>
<pre><code class="cpp">void ShowMenu()
&#123;
    cout &lt;&lt; &quot;1.添加用户&quot; &lt;&lt; endl;
    cout &lt;&lt; &quot;2.删除用户&quot; &lt;&lt; endl;
    cout &lt;&lt; &quot;3.显示用户&quot; &lt;&lt; endl;
    cout &lt;&lt; &quot;4.查找用户&quot; &lt;&lt; endl;
    cout &lt;&lt; &quot;5.修改用户数据&quot; &lt;&lt; endl;
    cout &lt;&lt; &quot;6.格式化数据库&quot; &lt;&lt; endl;
    cout &lt;&lt; &quot;0.退出数据库&quot; &lt;&lt; endl;
&#125;
</code></pre>
<h3 id="二，退出-Break-功能制作"><a href="#二，退出-Break-功能制作" class="headerlink" title="二，退出(Break)功能制作"></a>二，退出(Break)功能制作</h3><p>对于用户的选择进行操作，这里选用<code>switch()</code>语句<br>代码:</p>
<pre><code class="cpp">int SelectFunction = 0;
while (true)
&#123;
    ShowMenu();
    cin &gt;&gt; SelectFunction;
    switch (SelectFunction)
    &#123;
    case 1:
        break;
    case 2:
        break;
    case 3:
        break;
    case 4:
        break;
    case 5:
        break;
    case 6:
        break;
    case 0:cout &lt;&lt; &quot;欢迎再次使用！&quot; &lt;&lt; endl;
        system(&quot;pause&quot;);
        return 0;
    default:
        break;
    &#125;
&#125;
</code></pre>
<h3 id="三，添加账户"><a href="#三，添加账户" class="headerlink" title="三，添加账户"></a>三，添加账户</h3><p>首先使用<code>struct</code>结构体声明两个变量，一个为用户，一个为数据库</p>
<pre><code class="cpp">struct User
&#123;
    int AccountID;
    string AccoountName;
    string AccountPassword;
    string EmailAddress;
    string RegisterTime;
    bool LoginAccountSafetyCheck;
&#125;;

struct DataLib
&#123;
    struct User Account[MaxAccountQuality];
    int UserID;
&#125;;
</code></pre>
<p>然后实现添加用户的功能，用户输入的用户名，邮箱需要在数据库当中进行检查是否重复，输入密码时需要二次确认输入的密码</p>
<pre><code class="cpp">void AddAccount(DataLib *DL)
&#123;
    system(&quot;cls&quot;);
    if (DL-&gt;UserID == 0)
    &#123;
        DL-&gt;UserID++;
    &#125;
    if (DL-&gt;UserID == MaxAccountQuality)
    &#123;
        cout &lt;&lt; &quot;用户数量已打上限，无法添加！&quot; &lt;&lt; endl;
        return;
    &#125;
    string Name;
    string Password, Password_Again;
    string Email;
    cout &lt;&lt; &quot;请输入用户名：&quot; &lt;&lt; endl;
    cin &gt;&gt; Name;
    for (int Check = 1; Check &lt;= MaxAccountQuality; Check++)
    &#123;
        if (DL-&gt;Account[Check].AccountID == 0)
        &#123;
            break;
        &#125;
        if (Name == DL-&gt;Account[Check].AccoountName)
        &#123;
            cout &lt;&lt; &quot;账户名称重复，请重新输入&quot; &lt;&lt; endl;
            cin &gt;&gt; Name;
            Check;
        &#125;
    &#125;
    cout &lt;&lt; &quot;请输入密码：&quot; &lt;&lt; endl;
    cin &gt;&gt; Password;
    while (true)
    &#123;
        cout &lt;&lt; &quot;再次输入密码以确认：&quot; &lt;&lt; endl;
        cin &gt;&gt; Password_Again;
        if (Password_Again == Password)
        &#123;
            break;
        &#125;
        cout &lt;&lt; &quot;两次输入的不一致，请重新输入：&quot; &lt;&lt; endl;
    &#125;
    cout &lt;&lt; &quot;请输入邮箱：&quot; &lt;&lt; endl;
    cin &gt;&gt; Email;
    for (int Check = 1; Check &lt;= MaxAccountQuality; Check++)
    &#123;
        if (DL-&gt;Account[Check].AccountID == 0)
        &#123;
            break;
        &#125;
        if (Email == DL-&gt;Account[Check].EmailAddress)
        &#123;
            cout &lt;&lt; &quot;账户名称重复，请重新输入&quot; &lt;&lt; endl;
            cin &gt;&gt; Email;
            Check;
        &#125;
    &#125;

    DL-&gt;Account[MaxAccountQuality].AccoountName = Name;
    DL-&gt;Account[MaxAccountQuality].AccountPassword = Password_Again;
    DL-&gt;Account[MaxAccountQuality].EmailAddress = Email;
    DL-&gt;Account[MaxAccountQuality].AccountID = DL-&gt;UserID;
    cout &lt;&lt; &quot;添加完成！&quot; &lt;&lt; endl;
    system(&quot;cls&quot;);
    return;
&#125;
</code></pre>
<p>突然不想写了  </p>
<h1 id="拜"><a href="#拜" class="headerlink" title="拜"></a>拜</h1><p>直接上代码：</p>
<pre><code class="cpp">#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;ctime&gt;
#include &lt;direct.h&gt;
#include &lt;io.h&gt;
#include &lt;fstream&gt;
#include &lt;nlohmann/json.hpp&gt;
#include &lt;filesystem&gt;

#define MaxAccountQuality 1001
#define MaxFolderAccountQuality 100

using namespace std;
namespace fs = std::filesystem;


void ShowMenu()
&#123;
    cout &lt;&lt; &quot;1.添加用户&quot; &lt;&lt; endl;
    cout &lt;&lt; &quot;2.删除用户&quot; &lt;&lt; endl;
    cout &lt;&lt; &quot;3.显示用户&quot; &lt;&lt; endl;
    cout &lt;&lt; &quot;4.查找用户&quot; &lt;&lt; endl;
    cout &lt;&lt; &quot;5.修改用户数据&quot; &lt;&lt; endl;
    cout &lt;&lt; &quot;6.格式化数据库&quot; &lt;&lt; endl;
    cout &lt;&lt; &quot;0.退出数据库&quot; &lt;&lt; endl;
&#125;

struct User
&#123;
    int AccountID;
    string AccountName;
    string AccountPassword;
    string EmailAddress;
    string RegisterTime;
    bool LoginAccountSafetyCheck;
&#125;;

struct DataLib
&#123;
    struct User Account[MaxAccountQuality];
    int UserID;
&#125;;

tm* GetTime()
&#123;
    time_t nowtime;
    time(&amp;nowtime); //获取1970年1月1日0点0分0秒到现在经过的秒数
    tm* NowTime = localtime(&amp;nowtime); //将秒数转换为本地时间,年从1900算起,需要+1900,月为0-11,所以要+1
    return NowTime;
&#125;

void CheckDataLibFolder()
&#123;
    string DataLibFolderPosition = &quot;./DataLib&quot;;
    if (_access(DataLibFolderPosition.c_str(), 0) == -1)
    &#123;
        cout &lt;&lt; &quot;数据库不存在，创建中...&quot; &lt;&lt; endl;
        int datalibfolderposition = _mkdir(DataLibFolderPosition.c_str());
        cout &lt;&lt; &quot;创建完成！&quot; &lt;&lt; endl;
    &#125;
    else &#123;
        cout &lt;&lt; &quot;文件夹存在&quot; &lt;&lt; endl;
    &#125;
    system(&quot;cls&quot;);
&#125;

void CheckAccountInformationFile()
&#123;
    int FolderQuality = MaxAccountQuality / MaxFolderAccountQuality;
    int TheRestQuality = MaxAccountQuality % MaxFolderAccountQuality;
    int BeginQuality = 0;
    int EndQuality = 0;
    int LastEndQuality = 0;

    for (int Folder = 0; Folder &lt; FolderQuality; Folder++)
    &#123;
        BeginQuality = (Folder*MaxFolderAccountQuality) + 1;
        EndQuality = BeginQuality + (MaxFolderAccountQuality - 1);
        string FolderPosition = &quot;./DataLib/&quot; + to_string(BeginQuality) + &quot;-&quot; + to_string(EndQuality);
        if (_access(FolderPosition.c_str(), 0) == -1)
        &#123;
            cout &lt;&lt; &quot;文件夹不存在，创建中...&quot; &lt;&lt; endl;
            int folderposition = _mkdir(FolderPosition.c_str());
            cout &lt;&lt; &quot;创建完成！&quot; &lt;&lt; endl;
        &#125;
        else &#123;
            cout &lt;&lt; &quot;文件夹存在&quot; &lt;&lt; endl;
        &#125;
        if (Folder == FolderQuality)
        &#123;
            LastEndQuality = EndQuality + TheRestQuality;
            string FolderPosition = &quot;./DataLib/&quot; + to_string(BeginQuality) + &quot;-&quot; + to_string(LastEndQuality);
            if (_access(FolderPosition.c_str(), 0) == -1)
            &#123;
                cout &lt;&lt; &quot;文件夹不存在，创建中...&quot; &lt;&lt; endl;
                int folderposition = _mkdir(FolderPosition.c_str());
                cout &lt;&lt; &quot;创建完成！&quot; &lt;&lt; endl;
            &#125;
            else &#123;
                cout &lt;&lt; &quot;文件夹存在&quot; &lt;&lt; endl;
            &#125;
        &#125;
    &#125;
    system(&quot;cls&quot;);
&#125;

int ReadDataLib(DataLib *DL)
&#123;
    int FolderQuality = MaxAccountQuality / MaxFolderAccountQuality;
    int TheRestQuality = MaxAccountQuality % MaxFolderAccountQuality;
    int BeginQuality = 0;
    int EndQuality = 0;
    int LastEndQuality = 0;

    int AccountQuality = 1;

    for (int Folder = 0; Folder &lt; FolderQuality; Folder++)
    &#123;
        BeginQuality = (Folder * MaxFolderAccountQuality) + 1;
        EndQuality = BeginQuality + (MaxFolderAccountQuality - 1);
        if (Folder != FolderQuality)
        &#123;
            string CD = &quot;cd ./DataLib/&quot; + to_string(BeginQuality) + &quot;-&quot; + to_string(EndQuality);
            for (int Check = BeginQuality; Check &lt;= EndQuality; Check++)
            &#123;
                ifstream ReadAccountJson(&quot;./DataLib/&quot; + to_string(BeginQuality) + &quot;-&quot; + to_string(EndQuality) + &quot;/&quot; + to_string(Check) + &quot;.json&quot;);
                if (!ReadAccountJson.is_open())
                &#123;
                    cout &lt;&lt; &quot;没有该用户。&quot; &lt;&lt; endl;
                &#125;
                else &#123;
                    cout &lt;&lt; &quot;读取文件中...&quot; &lt;&lt; endl;
                    // 读取JSON文件到字符串
                    std::string json_str((std::istreambuf_iterator&lt;char&gt;(ReadAccountJson)), std::istreambuf_iterator&lt;char&gt;());
                    // 解析JSON字符串
                    nlohmann::json j = nlohmann::json::parse(json_str, nullptr, false);
                    
                    DL-&gt;Account[Check].AccountID = j[&quot;ID&quot;];
                    DL-&gt;Account[Check].AccountName = j[&quot;Name&quot;];
                    DL-&gt;Account[Check].EmailAddress = j[&quot;EmailAddress&quot;];
                    DL-&gt;Account[Check].AccountPassword = j[&quot;Password&quot;];
                    DL-&gt;Account[Check].RegisterTime = j[&quot;Register&quot;];
                    DL-&gt;Account[Check].LoginAccountSafetyCheck = j[&quot;SafetyCheck&quot;];
                    AccountQuality++;
                    cout &lt;&lt; &quot;读取完成！&quot; &lt;&lt; endl;
                &#125;
            &#125;
        &#125;
        else &#123;
            LastEndQuality = EndQuality + TheRestQuality;
            string CD = &quot;cd ./DataLib/&quot; + to_string(BeginQuality) + &quot;-&quot; + to_string(LastEndQuality);
            for (int Check = BeginQuality; Check &lt;= LastEndQuality; Check++)
            &#123;
                ifstream ReadAccountJson(&quot;./DataLib/&quot; + to_string(BeginQuality) + &quot;-&quot; + to_string(EndQuality) + &quot;/&quot; + to_string(Check) + &quot;.json&quot;);
                if (!ReadAccountJson.is_open())
                &#123;
                    cout &lt;&lt; &quot;没有该用户。&quot; &lt;&lt; endl;
                &#125;
                else &#123;
                    cout &lt;&lt; &quot;读取文件中...&quot; &lt;&lt; endl;
                    // 读取JSON文件到字符串
                    std::string json_str((std::istreambuf_iterator&lt;char&gt;(ReadAccountJson)), std::istreambuf_iterator&lt;char&gt;());
                    // 解析JSON字符串
                    nlohmann::json j = nlohmann::json::parse(json_str, nullptr, false);

                    DL-&gt;Account[Check].AccountID = j[&quot;ID&quot;];
                    DL-&gt;Account[Check].AccountName = j[&quot;Name&quot;];
                    DL-&gt;Account[Check].EmailAddress = j[&quot;EmailAddress&quot;];
                    DL-&gt;Account[Check].AccountPassword = j[&quot;Password&quot;];
                    DL-&gt;Account[Check].RegisterTime = j[&quot;Register&quot;];
                    DL-&gt;Account[Check].LoginAccountSafetyCheck = j[&quot;SafetyCheck&quot;];
                    AccountQuality++;
                    cout &lt;&lt; &quot;读取完成！&quot; &lt;&lt; endl;
                &#125;
            &#125;
        &#125;
    &#125;
    system(&quot;cls&quot;);
    return AccountQuality;
&#125;

void AddAccount(DataLib * DL)
&#123;
    system(&quot;cls&quot;);
    if (DL-&gt;UserID == 0)
    &#123;
        DL-&gt;UserID++;
    &#125;
    if (DL-&gt;UserID == MaxAccountQuality)
    &#123;
        cout &lt;&lt; &quot;用户数量已达上限，无法添加！&quot; &lt;&lt; endl;
        return;
    &#125;

    string Name;
    string Password, Password_Again;
    string Email;

    cout &lt;&lt; &quot;请输入用户名：&quot; &lt;&lt; endl;
    cin &gt;&gt; Name;
    int Check = 1;
    while (Check != MaxAccountQuality)
    &#123;
        if (DL-&gt;Account[Check].AccountID == 0)
        &#123;
            break;
        &#125;
        if (Name == DL-&gt;Account[Check].AccountName)
        &#123;
            cout &lt;&lt; &quot;账号邮箱重复，请重新输入&quot; &lt;&lt; endl;
            cin &gt;&gt; Name;
            Check = 1;
        &#125;
        else &#123;
            Check++;
        &#125;
    &#125;

    cout &lt;&lt; &quot;请输入密码：&quot; &lt;&lt; endl;
    cin &gt;&gt; Password;
    while (true)
    &#123;
        cout &lt;&lt; &quot;再次输入密码以确认：&quot; &lt;&lt; endl;
        cin &gt;&gt; Password_Again;
        if (Password_Again == Password)
        &#123;
            break;
        &#125;
        cout &lt;&lt; &quot;两次输入的不一致，请重新输入：&quot; &lt;&lt; endl;
    &#125;

    cout &lt;&lt; &quot;请输入邮箱：&quot; &lt;&lt; endl;
    cin &gt;&gt; Email;
    Check = 1;
    while (Check != MaxAccountQuality)
    &#123;
        if (DL-&gt;Account[Check].AccountID == 0)
        &#123;
            break;
        &#125;
        if (Email == DL-&gt;Account[Check].EmailAddress)
        &#123;
            cout &lt;&lt; &quot;账号邮箱重复，请重新输入&quot; &lt;&lt; endl;
            cin &gt;&gt; Email;
            Check = 1;
        &#125;
        else &#123;
            Check++;
        &#125;
    &#125;

    string RegisterTime;
    tm* RTime = GetTime();
    RegisterTime = to_string(RTime-&gt;tm_year + 1900) + &quot;-&quot; + to_string(RTime-&gt;tm_mon + 1) + &quot;-&quot; + to_string(RTime-&gt;tm_mday) + &quot;-&quot; + to_string(RTime-&gt;tm_hour) + &quot;:&quot; + to_string(RTime-&gt;tm_min) + &quot;:&quot; + to_string(RTime-&gt;tm_sec);

    DL-&gt;Account[DL-&gt;UserID].AccountName = Name;
    DL-&gt;Account[DL-&gt;UserID].AccountPassword = Password_Again;
    DL-&gt;Account[DL-&gt;UserID].EmailAddress = Email;
    DL-&gt;Account[DL-&gt;UserID].AccountID = DL-&gt;UserID;
    DL-&gt;Account[DL-&gt;UserID].LoginAccountSafetyCheck = true;
    DL-&gt;Account[DL-&gt;UserID].RegisterTime = RegisterTime;

    nlohmann::json j;
    j[&quot;ID&quot;] = DL-&gt;Account[DL-&gt;UserID].AccountID;
    j[&quot;Name&quot;] = DL-&gt;Account[DL-&gt;UserID].AccountName;
    j[&quot;EmailAddress&quot;] = DL-&gt;Account[DL-&gt;UserID].EmailAddress;
    j[&quot;Password&quot;] = DL-&gt;Account[DL-&gt;UserID].AccountPassword;
    j[&quot;Register&quot;] = DL-&gt;Account[DL-&gt;UserID].RegisterTime;
    j[&quot;SafetyCheck&quot;] = DL-&gt;Account[DL-&gt;UserID].LoginAccountSafetyCheck;
    int BeginFolderPosition = DL-&gt;UserID / MaxFolderAccountQuality;
    int EndFolderPosition = DL-&gt;UserID % MaxFolderAccountQuality;
    int BeginFilePosition = (BeginFolderPosition * MaxFolderAccountQuality) + 1;
    int EndFilePosition = BeginFilePosition + (MaxFolderAccountQuality - 1);

    string FolderPosition = &quot;./DataLib/&quot; + to_string(BeginFilePosition) + &quot;-&quot; + to_string(EndFilePosition) + &quot;/&quot;;
    
    string JsonFileName = FolderPosition + to_string(DL-&gt;UserID) + &quot;.json&quot;;
    ofstream UserJsonFile(JsonFileName);
    UserJsonFile &lt;&lt; j.dump(4);
    if (UserJsonFile.good())
    &#123;
        cout &lt;&lt; &quot;用户json文件创建成功！&quot; &lt;&lt; endl;
    &#125;
    else &#123;
        cout &lt;&lt; &quot;用户json文件创建失败！&quot; &lt;&lt; endl;
    &#125;


    cout &lt;&lt; &quot;添加完成！&quot; &lt;&lt; endl;
    system(&quot;pause&quot;);
    system(&quot;cls&quot;);
&#125;

void DeleteAccount(DataLib *DL)
&#123;
    int SelectAccountID = 0;
    string Password;
    cout &lt;&lt; &quot;输入你要删除的用户的ID：&quot; &lt;&lt; endl;
    cin &gt;&gt; SelectAccountID;
    while (true)
    &#123;
        if (0 &lt; SelectAccountID &lt; MaxAccountQuality)
        &#123;
            if (DL-&gt;Account[SelectAccountID].AccountID == 0)
            &#123;
                cout &lt;&lt; &quot;用户不存在，请重新输入!&quot; &lt;&lt; endl;
                cout &lt;&lt; &quot;输入你要删除的用户的ID：&quot; &lt;&lt; endl;
                cin &gt;&gt; SelectAccountID;
            &#125;
            else &#123;
                break;
            &#125;
        &#125;
    &#125;	

    while (true)
    &#123;
        cout &lt;&lt; &quot;输入密码以确认：&quot; &lt;&lt; endl;
        cin &gt;&gt; Password;
        if (Password == DL-&gt;Account[SelectAccountID].AccountPassword)
        &#123;
            break;
        &#125;
        cout &lt;&lt; &quot;密码错误，请重新输入！&quot; &lt;&lt; endl;
    &#125;

    bool Ensure = true;

    do
    &#123;
        cout &lt;&lt; &quot;确认删除？（0同意，大于1不同意）&quot; &lt;&lt; endl;
        cin &gt;&gt; Ensure;
        if (Ensure == false)
        &#123;
            break;
        &#125;
        else &#123;
            system(&quot;cls&quot;);
            return;
        &#125;
    &#125; while (true);

    cout &lt;&lt; &quot;删除中...&quot; &lt;&lt; endl;
    DL-&gt;Account[SelectAccountID].AccountID = 0;

    int BeginFolderPosition = DL-&gt;UserID / MaxFolderAccountQuality;
    int EndFolderPosition = DL-&gt;UserID % MaxFolderAccountQuality;
    int BeginFilePosition = (BeginFolderPosition * MaxFolderAccountQuality) + 1;
    int EndFilePosition = BeginFilePosition + (MaxFolderAccountQuality - 1);

    string FolderPosition = &quot;./DataLib/&quot; + to_string(BeginFilePosition) + &quot;-&quot; + to_string(EndFilePosition) + &quot;/&quot; + to_string(SelectAccountID) + &quot;.json&quot;;

    // 删除文件
    try &#123;
        // 检查文件是否存在
        if (fs::exists(FolderPosition)) &#123;
            // 删除文件
            fs::remove(FolderPosition);
            std::cout &lt;&lt; &quot;文件已删除&quot; &lt;&lt; std::endl;
            cout &lt;&lt; &quot;删除完成！&quot; &lt;&lt; endl;
        &#125;
        else &#123;
            std::cout &lt;&lt; &quot;文件不存在&quot; &lt;&lt; std::endl;
        &#125;
    &#125;
    catch (const fs::filesystem_error&amp; e) &#123;
        std::cerr &lt;&lt; &quot;错误: &quot; &lt;&lt; e.what() &lt;&lt; std::endl;
    &#125;
    system(&quot;pause&quot;);
    system(&quot;cls&quot;);
&#125;

void ExhibitAccount(DataLib *DL)
&#123;
    system(&quot;cls&quot;);
    int AccountQuality = 0;
    for (int Check = 1; Check &lt; MaxAccountQuality; Check++)
    &#123;
        if (AccountQuality == DL-&gt;UserID - 1)
        &#123;
            system(&quot;pause&quot;);
            system(&quot;cls&quot;);
            return;
        &#125;
        if (DL-&gt;Account[Check].AccountID == 0)
        &#123;
            continue;
        &#125;
        else &#123;
            cout &lt;&lt; to_string(Check) + &quot;.&quot; + DL-&gt;Account[Check].AccountName &lt;&lt; endl;
            AccountQuality++;
        &#125;
    &#125;
&#125;

void UseIDFind(DataLib* DL, int id)
&#123;
    while (true)
    &#123;
        cout &lt;&lt; &quot;输入用户ID:&quot; &lt;&lt; endl;
        cin &gt;&gt; id;
        if (0 &lt; id &lt; MaxAccountQuality)
        &#123;
            if (DL-&gt;Account[id].AccountID != 0)
            &#123;
                break;
            &#125;
        &#125;
        cout &lt;&lt; &quot;用户不存在，请重新输入！&quot; &lt;&lt; endl;
    &#125;
    system(&quot;cls&quot;);
    cout &lt;&lt; &quot;用户名：&quot; &lt;&lt; DL-&gt;Account[id].AccountName &lt;&lt; endl;
    cout &lt;&lt; &quot;用户ID：&quot; &lt;&lt; DL-&gt;Account[id].AccountID &lt;&lt; endl;
    cout &lt;&lt; &quot;邮箱：&quot; &lt;&lt; DL-&gt;Account[id].EmailAddress &lt;&lt; endl;
    cout &lt;&lt; &quot;注册时间：&quot; &lt;&lt; DL-&gt;Account[id].RegisterTime &lt;&lt; endl;
    system(&quot;pause&quot;);
&#125;

void UseNameFind(DataLib* DL, string name)
&#123;
    int id = 0;
    while (true)
    &#123;
        cout &lt;&lt; &quot;输入用户名:&quot; &lt;&lt; endl;
        cin &gt;&gt; name;
        for (int Check = 1; Check &lt; MaxAccountQuality; Check++)
        &#123;
            if (name == DL-&gt;Account[Check].AccountName)
            &#123;
                id = DL-&gt;Account[Check].AccountID;
                break;
            &#125;
        &#125;
        if (DL-&gt;Account[id].AccountID != 0)
        &#123;
            break;
        &#125;
        cout &lt;&lt; &quot;用户不存在，请重新输入！&quot; &lt;&lt; endl;
    &#125;
    system(&quot;cls&quot;);
    cout &lt;&lt; &quot;用户名：&quot; &lt;&lt; DL-&gt;Account[id].AccountName &lt;&lt; endl;
    cout &lt;&lt; &quot;用户ID：&quot; &lt;&lt; DL-&gt;Account[id].AccountID &lt;&lt; endl;
    cout &lt;&lt; &quot;邮箱：&quot; &lt;&lt; DL-&gt;Account[id].EmailAddress &lt;&lt; endl;
    cout &lt;&lt; &quot;注册时间：&quot; &lt;&lt; DL-&gt;Account[id].RegisterTime &lt;&lt; endl;
    system(&quot;pause&quot;);
&#125;

void FindAccount(DataLib* DL)
&#123;
    system(&quot;cls&quot;);
    int ID = 0;
    string Name;
    cout &lt;&lt; &quot;1.ID查询&quot; &lt;&lt; endl;
    cout &lt;&lt; &quot;2.用户名查询&quot; &lt;&lt; endl;
    cout &lt;&lt; &quot;0.返回&quot; &lt;&lt; endl;
    int SeletchFindWay = 0;
    while (true)
    &#123;
        cin &gt;&gt; SeletchFindWay;
        switch (SeletchFindWay)
        &#123;
        case 1:UseIDFind(DL, ID);
            return;
        case 2:UseNameFind(DL, Name);
            return;
        case 0:
            system(&quot;pause&quot;);
            system(&quot;cls&quot;);
            return;
        default:
            break;
        &#125;
    &#125;
&#125;

void CorrectAccountName(DataLib* DL, string name, int id,string path)
&#123;
    cout &lt;&lt; &quot;请输入要更改的用户名：&quot; &lt;&lt; endl;
    cin &gt;&gt; name;
    for (int Check = 1; Check &lt;= MaxAccountQuality; Check++)
    &#123;
        if (name == DL-&gt;Account[id].AccountName)
        &#123;
            cout &lt;&lt; &quot;与当前使用账户名重复。&quot; &lt;&lt; endl;
            cout &lt;&lt; &quot;请输入要更改的用户名：&quot; &lt;&lt; endl;
            cin &gt;&gt; name;
            Check = 1;
        &#125;
        if (name == DL-&gt;Account[Check].AccountName)
        &#123;
            cout &lt;&lt; &quot;此用户名已被使用&quot; &lt;&lt; endl;
            cout &lt;&lt; &quot;请输入要更改的用户名：&quot; &lt;&lt; endl;
            cin &gt;&gt; name;
            Check = 1;
        &#125;
    &#125;
    DL-&gt;Account[id].AccountName = name;

    std::ifstream i(path);
    nlohmann::json j;
    i &gt;&gt; j;

    // 修改JSON元素的值
    j[&quot;Name&quot;] = DL-&gt;Account[id].AccountName;

    // 将更改后的JSON数据写回文件
    std::ofstream o(path);
    o &lt;&lt; j.dump(4); // 4是缩进级别，用于美化输出

    cout &lt;&lt; &quot;修改完成！&quot; &lt;&lt; endl;
&#125;

void CorrectAccountPassword(DataLib* DL, string password, string password_again, int id,string path)
&#123;
    string pwd;

    while (true)
    &#123;
        cout &lt;&lt; &quot;请输入当前密码：&quot; &lt;&lt; endl;
        cin &gt;&gt; pwd;
        if (pwd == DL-&gt;Account[id].AccountPassword)
        &#123;
            break;
        &#125;
        cout &lt;&lt; &quot;密码错误！&quot; &lt;&lt; endl;
    &#125;

    cout &lt;&lt; &quot;请输入要修改的密码：&quot; &lt;&lt; endl;
    cin &gt;&gt; password;
    while (true)
    &#123;
        cout &lt;&lt; &quot;再次输入以确认:&quot; &lt;&lt; endl;
        cin &gt;&gt; password_again;
        if (password_again == password)
        &#123;
            break;
        &#125;
        cout &lt;&lt; &quot;两次输入的不一致！&quot; &lt;&lt; endl;
    &#125;
    DL-&gt;Account[id].AccountPassword = password_again;

    std::ifstream i(path);
    nlohmann::json j;
    i &gt;&gt; j;

    // 修改JSON元素的值
    j[&quot;Password&quot;] = DL-&gt;Account[id].AccountPassword;

    // 将更改后的JSON数据写回文件
    std::ofstream o(path);
    o &lt;&lt; j.dump(4); // 4是缩进级别，用于美化输出

    cout &lt;&lt; &quot;修改完成！&quot; &lt;&lt; endl;
&#125;

void CorrectEmailAddress(DataLib* DL, string email, int id,string path)
&#123;
    cout &lt;&lt; &quot;请输入要更改的邮箱：&quot; &lt;&lt; endl;
    cin &gt;&gt; email;
    for (int Check = 1; Check &lt;= MaxAccountQuality; Check++)
    &#123;
        if (email == DL-&gt;Account[id].EmailAddress)
        &#123;
            cout &lt;&lt; &quot;与当前绑定邮箱重复。&quot; &lt;&lt; endl;
            cout &lt;&lt; &quot;请输入要更改的邮箱：&quot; &lt;&lt; endl;
            cin &gt;&gt; email;
            Check = 1;
        &#125;
        if (email == DL-&gt;Account[Check].EmailAddress)
        &#123;
            cout &lt;&lt; &quot;此邮箱已绑定&quot; &lt;&lt; endl;
            cout &lt;&lt; &quot;请输入要更改的邮箱：&quot; &lt;&lt; endl;
            cin &gt;&gt; email;
            Check = 1;
        &#125;
    &#125;
    DL-&gt;Account[id].EmailAddress = email;

    std::ifstream i(path);
    nlohmann::json j;
    i &gt;&gt; j;

    // 修改JSON元素的值
    j[&quot;EmailAddress&quot;] = DL-&gt;Account[id].EmailAddress;

    // 将更改后的JSON数据写回文件
    std::ofstream o(path);
    o &lt;&lt; j.dump(4); // 4是缩进级别，用于美化输出

    cout &lt;&lt; &quot;修改完成！&quot; &lt;&lt; endl;
&#125;

void CorrectSafetyCheck(DataLib *DL, bool safetycheck, int id,string path)
&#123;
    bool Select = true;

    do
    &#123;
        cout &lt;&lt; &quot;开启还是关闭？（0关闭，大于1为开）&quot; &lt;&lt; endl;
        cin &gt;&gt; Select;
        if (Select == false)
        &#123;
            if (DL-&gt;Account[id].LoginAccountSafetyCheck != false)
            &#123;
                DL-&gt;Account[id].LoginAccountSafetyCheck = false;
                cout &lt;&lt; &quot;关闭成功！&quot; &lt;&lt; endl;

                std::ifstream i(path);
                nlohmann::json j;
                i &gt;&gt; j;

                // 修改JSON元素的值
                j[&quot;SafetyCheck&quot;] = DL-&gt;Account[id].LoginAccountSafetyCheck;

                // 将更改后的JSON数据写回文件
                std::ofstream o(path);
                o &lt;&lt; j.dump(4); // 4是缩进级别，用于美化输出

                break;
            &#125;
            cout &lt;&lt; &quot;已经关闭！&quot; &lt;&lt; endl;
        &#125;
        else &#123;
            if (DL-&gt;Account[id].LoginAccountSafetyCheck != true)
            &#123;
                DL-&gt;Account[id].LoginAccountSafetyCheck = true;

                std::ifstream i(path);
                nlohmann::json j;
                i &gt;&gt; j;

                // 修改JSON元素的值
                j[&quot;SafetyCheck&quot;] = DL-&gt;Account[id].LoginAccountSafetyCheck;

                // 将更改后的JSON数据写回文件
                std::ofstream o(path);
                o &lt;&lt; j.dump(4); // 4是缩进级别，用于美化输出

                cout &lt;&lt; &quot;开启成功！&quot; &lt;&lt; endl;
                break;
            &#125;
            cout &lt;&lt; &quot;已经开启！&quot; &lt;&lt; endl;
        &#125;
    &#125; while (true);
&#125;

void CorrectAccountInformation(DataLib* DL)
&#123;
    system(&quot;cls&quot;);
    string Name;
    string Password, Password_Again;
    string Email;
    bool SafetyCheck = true;

    int ID = 0;
    while (true)
    &#123;
        cout &lt;&lt; &quot;输入要修改的用户ID:&quot; &lt;&lt; endl;
        cin &gt;&gt; ID;
        if (0 &lt; ID &lt; MaxAccountQuality)
        &#123;
            if (DL-&gt;Account[ID].AccountID != 0)
            &#123;
                break;
            &#125;
        &#125;
        cout &lt;&lt; &quot;用户不存在，请重新输入！&quot; &lt;&lt; endl;
    &#125;

    int BeginFolderPosition = DL-&gt;Account[ID].AccountID / MaxFolderAccountQuality;
    int EndFolderPosition = DL-&gt;Account[ID].AccountID % MaxFolderAccountQuality;
    int BeginFilePosition = (BeginFolderPosition * MaxFolderAccountQuality) + 1;
    int EndFilePosition = BeginFilePosition + (MaxFolderAccountQuality - 1);

    string AccountJsonPosition = &quot;./DataLib/&quot; + to_string(BeginFilePosition) + &quot;-&quot; + to_string(EndFilePosition) + &quot;/&quot; + to_string(ID) + &quot;.json&quot;;


    system(&quot;cls&quot;);
    cout &lt;&lt; &quot;1.修改用户名&quot; &lt;&lt; endl;
    cout &lt;&lt; &quot;2.修改密码&quot; &lt;&lt; endl;
    cout &lt;&lt; &quot;3.修改邮箱&quot; &lt;&lt; endl;
    cout &lt;&lt; &quot;4.修改安全设置&quot; &lt;&lt; endl;
    cout &lt;&lt; &quot;0.返回&quot; &lt;&lt; endl;

    int SelectCorrectType;
    while (true)
    &#123;
        cin &gt;&gt; SelectCorrectType;
        switch (SelectCorrectType)
        &#123;
        case 1:CorrectAccountName(DL, Name, ID, AccountJsonPosition);
            return;
        case 2:CorrectAccountPassword(DL, Password, Password_Again, ID, AccountJsonPosition);
            return;
        case 3:CorrectEmailAddress(DL, Email, ID, AccountJsonPosition);
            return;
        case 4:CorrectSafetyCheck(DL, SafetyCheck, ID, AccountJsonPosition);
            return;
        case 0:
            system(&quot;pause&quot;);
            system(&quot;cls&quot;);
            return;
        default:
            break;
        &#125;
    &#125;
&#125;

void removeDirectory(const fs::path&amp; dirPath,DataLib *DL) &#123;
    int AccountQuality = ReadDataLib(DL);
    int Quality = 0;
    try &#123;
        if (fs::exists(dirPath) &amp;&amp; fs::is_directory(dirPath)) &#123;
            fs::remove_all(dirPath);
            for (int Check = 1; Check &lt; MaxAccountQuality; Check++)
            &#123;
                if (Quality == AccountQuality - 1)
                &#123;
                    break;
                &#125;
                else &#123;
                    if (DL-&gt;Account[Check].AccountID != 0)
                    &#123;
                        cout &lt;&lt; &quot;清除账号：&quot; + to_string(DL-&gt;Account[Check].AccountID) + &quot;.&quot; + DL-&gt;Account[Check].AccountName &lt;&lt; endl;
                        DL-&gt;Account[Check].AccountID = 0;
                    &#125;
                &#125;
            &#125;
            std::cout &lt;&lt; &quot;Directory removed successfully.&quot; &lt;&lt; std::endl;
            cout &lt;&lt; &quot;老子删库跑路咯！&quot; &lt;&lt; endl;
        &#125;
        else &#123;
            std::cout &lt;&lt; &quot;Directory does not exist.&quot; &lt;&lt; std::endl;
        &#125;
    &#125;
    catch (const fs::filesystem_error&amp; e) &#123;
        std::cerr &lt;&lt; &quot;Error: &quot; &lt;&lt; e.what() &lt;&lt; std::endl;
    &#125;
&#125;

void DeleteDataLib(DataLib* DL)
&#123;
    system(&quot;cls&quot;);
    bool Ensure = true;

    do
    &#123;
        cout &lt;&lt; &quot;确认删除？（0同意，大于1不同意）&quot; &lt;&lt; endl;
        cin &gt;&gt; Ensure;
        if (Ensure == false)
        &#123;
            break;
        &#125;
        else &#123;
            system(&quot;cls&quot;);
            return;
        &#125;
    &#125; while (true);
    cout &lt;&lt; &quot;删除中...&quot; &lt;&lt; endl;
    removeDirectory(&quot;./DataLib&quot;, DL);
    system(&quot;pause&quot;);
    system(&quot;cls&quot;);
&#125;


int main()
&#123;
    DataLib DL;
    DL.UserID = 1;

    int Quality = ReadDataLib(&amp;DL);
    DL.UserID = Quality;



    int SelectFunction = 0;
    while (true)
    &#123;
        CheckDataLibFolder();
        CheckAccountInformationFile();
        int Quality = ReadDataLib(&amp;DL);
        DL.UserID = Quality;
        ShowMenu();
        cin &gt;&gt; SelectFunction;
        switch (SelectFunction)
        &#123;
        case 1:AddAccount(&amp;DL);
            break;
        case 2:DeleteAccount(&amp;DL);
            break;
        case 3:ExhibitAccount(&amp;DL);
            break;
        case 4:FindAccount(&amp;DL);
            break;
        case 5:CorrectAccountInformation(&amp;DL);
            break;
        case 6:DeleteDataLib(&amp;DL);
            break;
        case 0:cout &lt;&lt; &quot;欢迎再次使用！&quot; &lt;&lt; endl;
            system(&quot;pause&quot;);
            return 0;
        default:
            break;
        &#125;
    &#125;

    system(&quot;pause&quot;);
    return 0;
&#125;
</code></pre>

    </div>
    
    
    
    
    <div id="comment">
        <div id="giscus-container" class="giscus"></div>
    </div>
    
    
    
    <div id="comment">
        <div id="twikoo-container"></div>
    </div>
    
    
</div>

            <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2024 Ksayus の 猫窝
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;Ksayus
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

        </div>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/js/main.js"></script>
    
    
<script
    src="https://giscus.app/client.js"
    data-repo="ksayus/ksayus_personal_website_comments"
    data-repo-id="R_kgDONGFRoA"
    data-category="General"
    data-category-id="DIC_kwDONGFRoM4CjtOX"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="preferred_color_scheme"
    data-lang="zh-CN"
    crossorigin
    async
></script>




<script>
    twikoo.init({
        el: "#twikoo-container",
        envId: "",
        region: "",
        path: location.pathname,
        lang: "",
    })
</script>


    
</body>
</html>
